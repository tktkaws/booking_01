# 一覧表示の実装手順（会議室予約システム）

本書はトップページに予約の一覧を表示する最小実装の手順をまとめたものです。実装は Supabase の公開RLS（匿名 SELECT 可）を前提としています。

## 1. 取得API（確認用）
- 既存: `src/app/api/bookings/route.ts`
  - `GET /api/bookings` で `bookings` を最大20件返却
  - エラーハンドリング: 失敗時は 500 とメッセージ

（注）一覧は API 経由ではなく、サーバーコンポーネントから直接 Supabase を呼び出しています。API は動作確認/外部連携用です。

## 2. サーバーコンポーネントの追加
- 追加: `src/components/BookingsList.tsx`
  - `supabase.from('bookings').select(...).order('start_at').limit(50)` で取得
  - 表示項目: タイトル / 開始 / 終了 / 部署
  - フォーマット: `Intl.DateTimeFormat('ja-JP')` で日時整形
  - エラー時: 警告ボックス表示、データなし時: 空表示

## 3. トップページへの組み込み
- 変更: `src/app/page.tsx`
  - `BookingsList` を読み込み、カレンダーの下に「予約一覧」として表示

## 4. 動作確認手順
1) `.env.local` に以下を設定
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
2) `npm run dev`
3) ブラウザで `http://localhost:3000/` を開く
4) 予約一覧が表示されることを確認（シード済みの「テスト予約」が表示される）
5) APIの直接確認（任意）: `http://localhost:3000/api/bookings`

## 5. 今後の拡張（TODO）
- 期間フィルタ: 今日/週/月での範囲指定（サーバー側クエリに `gte/lte` 条件）
- 検索: タイトル/部署/作成者での部分一致検索
- ページネーション: `range` 指定または cursor 方式
- UI: 状態バッジ、ツールバー（期間切替・検索フォーム）、空状態の案内
- エラーハンドリング: 衝突・営業時間外エラーの文言統一
- Prisma 版実装: `withRlsUser` を使ったサーバーAPIでの取得（強い型付け）
